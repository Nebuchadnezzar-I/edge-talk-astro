import{j as e,B as d}from"./button.BI6niL5U.js";import{T as v}from"./textarea.BqRSn4iu.js";import{a as f}from"./_astro_actions.Dz5ahgF_.js";import{r as a}from"./index.DBH57-O4.js";import{c as j}from"./createLucideIcon.DqoxmQ87.js";import"./_commonjsHelpers.CqkleIqs.js";/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=j("ArrowBigLeft",[["path",{d:"M18 15h-6v4l-7-7 7-7v4h6v6z",key:"lbrdak"}]]);function k({sessionData:s}){if(!s)return null;s.chatHistory||(s.chatHistory=[{c:""},{s:""}]);const[i,c]=a.useState(s.chatHistory),[r,l]=a.useState(""),[p,h]=a.useState(!1),n=a.useRef(null),m=async()=>{h(!0),c(o=>[...o,{c:r}]),l(""),await f.addMessageToSession({id:s.id,type:"c",message:r});const t=await g();f.addMessageToSession({id:s.id,type:"s",message:t}),c(o=>[...o,{s:t}]),h(!1)},g=async()=>{const t="",o="https://api.openai.com/v1/chat/completions";try{const y=await(await fetch(o,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"system",content:`
                            You are a skilled negotiation opponent in a competitive setting. The context of this negotiation is: ${s.qna}. Your goal is to secure the best possible outcome for yourself, using any persuasive tactics, strategic arguments, and negotiation techniques at your disposal. This is the chat you've already had: ${i}.
                            Your approach should be assertive, focused, and resourceful. This is an opportunity for you to challenge your opponent while aiming for a favorable result. Let's begin with this message:
                            Human: "${r}"
                            Respond in a concise, strategic way—keep your replies focused, aiming for no more than 2-3 sentences. Challenge the opponent’s statements assertively and maintain a strong negotiating position.
                            Your Response:
                            `}],max_tokens:100,stop:[`
`]})})).json(),{choices:x}=y;return x[0]?.message?.content}catch(u){return console.error("Error fetching questions:",u),""}};return a.useEffect(()=>{n.current&&(n.current.scrollTop=n.current.scrollHeight)},[i]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full border-b py-3 flex items-center gap-5",children:[e.jsx("a",{href:"/n/",children:e.jsx(d,{variant:"outline",children:e.jsx(w,{})})}),e.jsxs("h1",{className:"text-xl font-bold",children:["Chat: ",s.id]})]}),e.jsx("div",{ref:n,className:"w-full h-full flex flex-col gap-3 overflow-y-auto pr-2",children:i.map((t,o)=>e.jsx("div",{className:t.s?"bg-secondary max-w-[70%] rounded-lg p-2 px-5":"border max-w-[70%] self-end rounded-lg p-2 px-5",children:e.jsx("p",{children:t.s||t.c})},o))}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(v,{placeholder:"Type a message",className:"w-full h-[120px]",onChange:t=>l(t.target.value),value:r}),e.jsx(d,{onClick:m,disabled:p,className:"h-full",children:p?"Wait...":"Send"})]})]})}export{k as ChatClient};
